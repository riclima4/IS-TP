{% extends "base.html" %}
{% block content %}
<div class="card">
    <h2 style="margin-top:0">Import XML and Save to DB</h2>
    <p class="muted">Upload an XML file and save it into firebase db.</p>

    <form method="post" action="/send_to_db" enctype="multipart/form-data">
        <div class="row">
            <div class="drop-zone" data-placeholder="Choose XML file (required)" id="importXmlZone">
                <span class="dz-label">Choose XML file (required)</span>
                <input type="file" id="xmlfile" name="xmlfile" accept=".xml" required style="display:none">
                <small>Drag & drop XML here or click</small>
            </div>

            <label for="server_url" style="margin-top:10px">XML-RPC Server URL <span class="muted">(testing
                    only)</span></label>
            <input type="text" id="server_url" name="server_url" value="{{ default_server_url }}"
                placeholder="http://localhost:8000" />

            <label for="method_name" style="margin-top:10px">Method name <span class="muted">(testing
                    only)</span></label>
            <input type="text" id="method_name" name="method_name" value="{{ default_method }}"
                placeholder="save_xml" />

            <div class="controls" style="margin-top:10px">
                <button class="btn" type="submit">Save to DB</button>
            </div>
        </div>
    </form>
</div>

{% if message is defined %}
<div class="card">
    <h3 style="margin:0 0 8px 0">Result</h3>
    <style>
        .msg.ok {
            color: green;
        }

        .msg.err {
            color: red;
        }
    </style>
    <pre class="msg {% if success %}ok{% else %}err{% endif %}">{{ message }}</pre>
</div>
{% endif %}

<script>
    const zone = document.getElementById('importXmlZone');
    if (zone) {
        zone.addEventListener('dragenter', () => zone.style.transform = 'scale(1.02)');
        zone.addEventListener('dragleave', () => zone.style.transform = 'scale(1)');
        zone.addEventListener('drop', () => zone.style.transform = 'scale(1)');
    }
</script>
{% endblock %}